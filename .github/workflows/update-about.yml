name: Update about.md
on:
  push:
  workflow_dispatch:
jobs:
  parse:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v2
        with:
          repository: Kagerou-Discord/Kagerou
      - name: Install hclq
        run: |
          curl -sSLo install.sh https://install.hclq.sh
          sh install.sh
      - run: sed -i "s/local.server_id/0/g" category.tf
      - run: |
          NAMES=$(cat category.tf | hclq get 'resource.discord_category_channel.*.name')
          NAMES=${NAMES#[}
          NAMES=${NAMES#]}
          NAMES=${NAMES##"}
          echo $NAMES
      - run: cat category.tf | hclq get 'resource.discord_category_channel.*.position'
      - run: sed -i "s/local.server_id/0/g" text_ch.tf
      # TODO: カテゴリをhuman readableに置き換える
      - run: sed -i -e "s/discord_category_channel\..*\.id/0/g" text_ch.tf
      - run: cat text_ch.tf | hclq get 'resource.discord_text_channel.*.name'
